{
  "version": 3,
  "sources": ["../../src/helpers.ts", "../../src/dx-img.ts"],
  "sourcesContent": ["export function cssObjectToString(css: any): string {\n  let str = \"\";\n  for (let key in css) {\n    str += `${key}: ${css[key]};`;\n  }\n  return str;\n}\n\nexport function mergeByIndex(arr1: any[], arr2: any[]): any[] {\n  let merged: any[] = [...arr1];\n  for (let i = 0; i < arr2.length; i++) {\n    if (i < merged.length) {\n      merged[i] = arr2[i];\n    } else {\n      merged.push(arr2[i]);\n    }\n  }\n  return merged;\n}\n\nexport function attachShadow(el: HTMLElement, init: ShadowRootInit) {\n  el.attachShadow(init);\n}\n\nexport function attachStyles(el: HTMLElement, styles: string) {\n  let sheet = new CSSStyleSheet();\n  sheet.replace(styles);\n  el.shadowRoot!.adoptedStyleSheets = [sheet];\n  return sheet;\n}\n\nexport function attachTemplate(el: HTMLElement, template: string) {\n  const templateEl = document.createElement(\"template\");\n  templateEl.innerHTML = template;\n  const node = templateEl.content.cloneNode(true);\n  el.shadowRoot!.appendChild(node);\n  return node;\n}\n", "import {\n  attachShadow,\n  attachStyles,\n  attachTemplate,\n  mergeByIndex,\n} from \"./helpers\";\n\nconst styles = `\n:host {\n  font-size: var(--dx-text-size, 14px);\n  font-family: var(--dx-text-font, Arial);\n  color: var(--dx-text-color, #000);\n}\n:host img {\n  transition: all 0.2s ease-in-out;\n}\n`;\n\nconst template = `<slot></slot>`;\n\nclass DomImg extends HTMLElement {\n  preload: boolean = false;\n  breakpoints: number[] = [0, 960, 1440];\n  height: string[] = [\"auto\"];\n  img: HTMLImageElement;\n  \"lazy-src\": string;\n  src: string;\n  width: string[] = [\"auto\"];\n  constructor() {\n    super();\n    attachShadow(this, { mode: \"open\" });\n    attachStyles(this, styles);\n    attachTemplate(this, template);\n    this.render = this.render.bind(this);\n    this.setupImageAndLazyLoading = this.setupImageAndLazyLoading.bind(this);\n    this.setupPreloading = this.setupPreloading.bind(this);\n    this.setupAttributes = this.setupAttributes.bind(this);\n    this.connectedCallback = this.connectedCallback.bind(this);\n  }\n  connectedCallback() {\n    this.setupAttributes()\n      .setupPreloading()\n      .setupImageAndLazyLoading()\n      .render();\n    window.addEventListener(\"resize\", this.render);\n  }\n  disconnectedCallback() {\n    window.removeEventListener(\"resize\", this.render);\n  }\n  render() {\n    const width = window.innerWidth;\n    this.breakpoints.forEach((bp, i) => {\n      if (width > bp) {\n        if (this.height[i]) this.img.style.height = this.height[i];\n        if (this.width[i]) this.img.style.width = this.width[i];\n      }\n    });\n  }\n  setupAttributes() {\n    DomImg.observedAttributes.forEach((attr) => {\n      const val = this.getAttribute(attr);\n      if (!val) return;\n      if (!Array.isArray(this[attr])) return (this[attr] = val);\n      return (this[attr] = mergeByIndex(this[attr], val.split(\",\")));\n    });\n    return this;\n  }\n  setupImageAndLazyLoading() {\n    const img = document.createElement(\"img\");\n    this.shadowRoot?.appendChild(img);\n    this.img = img;\n    if (this[\"lazy-src\"]) {\n      this.img.src = this[\"lazy-src\"];\n      let observer = new IntersectionObserver((entries, observer) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            let target = entry.target as HTMLImageElement;\n            target.src = this.src;\n            observer.unobserve(target);\n          }\n        });\n      });\n      observer.observe(img);\n    } else {\n      this.img.src = this.src;\n    }\n    return this;\n  }\n  setupPreloading() {\n    if (this.getAttribute(\"preload\") !== null) {\n      const link = document.createElement(\"link\");\n      link.rel = \"preload\";\n      link.as = \"image\";\n      link.href = this.src;\n      document.head.appendChild(link);\n    }\n    return this;\n  }\n  static get observedAttributes() {\n    return [\"height\", \"lazy-src\", \"preload\", \"src\", \"width\"];\n  }\n}\n\ncustomElements.define(\"dx-img\", DomImg);\n"],
  "mappings": "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",
  "names": ["styles", "template", "observer"]
}
